---
title: "Multivariate Project 1"
author: "Io"
date: "2025-04-23"
output: html_document
---
## Introduction

This report explores the relationship between education and perceptions of climate change, using data from the European Social Survey (ESS Round 11).

#### Loading Packages
```{r}
library(ggplot2)
library(dplyr)
library(readr)

```

#### Loading the dataset
```{r}
ESS11 <- read_csv("data/ESS11.csv")
```
## Exploratory data analysis

Some preliminary steps are taken in order to clean the data from NAs and to visualize variable distributions and some basic bivariate relationships.

#### Preparing the data

Beliefs about the causes of climate change - natural vs. human:
```{r}
ESS11$ccnthum[ESS11$ccnthum %in% c(55, 77, 88, 99)] <- NA

clim_change_cause <- factor(ESS11$ccnthum,
                        levels = c(1, 2, 3, 4, 5),
                        labels = c("Entirely natural", "Mainly natural", "Equally natural and human", "Mainly human", "Entirely human"))

```

Beliefs about individual responsibility in fighting climate change:

```{r}
ESS11$ccrdprs[ESS11$ccrdprs %in% c(66, 77, 88, 99)] <- NA

ESS11 <- ESS11 %>%
  mutate(
    clim_change_resp = case_when(
      ccrdprs >= 1 & ccrdprs <= 3 ~ "Low",
      ccrdprs >= 4 & ccrdprs <= 7 ~ "Medium",
      ccrdprs >= 8 & ccrdprs <= 10 ~ "High"
    ),
    clim_change_resp = factor(clim_change_resp, levels = c("Low", "Medium", "High"), ordered = TRUE)
  )
```

#### Descriptive statistics

Frequency tables are employed in order to better understand the distribution of the variables.

```{r}
summary(clim_change_cause)
prop.table(table(clim_change_cause))

summary(ESS11$clim_change_resp)
prop.table(table(ESS11$clim_change_resp))

summary(ESS11$edulvlb)
prop.table(table(ESS11$edulvlb))

summary(ESS11$edlvfit)
```

#### Plots

Bar graphs allow for the visualization of the univariate distribution of the variables associated with beliefs about climate change.
```{r}
ggplot(ESS11, aes(x = clim_change_cause)) +
  geom_bar(color = "purple", fill = "purple") +
  theme(axis.text.x = element_text(size = 8, angle = 45, hjust = 1),
         axis.text.y = element_text(size = 12)) +
  labs(title = "Beliefs about causes of climate change",
       x = "Natural vs. human",
       y = "Count")


ESS11 |> 
  filter(!is.na(clim_change_resp)) |>  #I want to exclude NAs from the bar graph
  ggplot(aes(x = clim_change_resp)) +
  geom_bar(color = "purple", fill = "purple") +
  theme(axis.text.x = element_text(size = 12, hjust = 1),
        axis.text.y = element_text(size = 12),
        plot.title = element_text(hjust = 0.5, size = 14, face = "bold")) +
  labs(title = "Feelings of personal responsibilities to reduce climate change",
       x = "Perceived responsibility",
       y = "Count")
```


